namespace Alumis.Text.Unicode
{
    partial class GraphemeString
    {
        internal struct GraphemeCluster
        {
            public Interval Interval, CodeUnitsInterval;

            public static bool Extends(uint a, uint b)
            {
                var A = GetPropertyValue(a);
                var B = GetPropertyValue(b);

                if (A == GraphemeClusterBreakType.Cr && B == GraphemeClusterBreakType.Lf)
                    return true;

                if (A == GraphemeClusterBreakType.Control || A == GraphemeClusterBreakType.Cr || A == GraphemeClusterBreakType.Lf || B == GraphemeClusterBreakType.Control || B == GraphemeClusterBreakType.Cr || B == GraphemeClusterBreakType.Lf)
                    return false;

                if (A == GraphemeClusterBreakType.L && (B == GraphemeClusterBreakType.L || B == GraphemeClusterBreakType.V || B == GraphemeClusterBreakType.Lv || B == GraphemeClusterBreakType.Lvt))
                    return true;

                if ((A == GraphemeClusterBreakType.Lv || A == GraphemeClusterBreakType.V) && (B == GraphemeClusterBreakType.V || B == GraphemeClusterBreakType.T))
                    return true;

                if ((A == GraphemeClusterBreakType.Lvt || A == GraphemeClusterBreakType.T) && B == GraphemeClusterBreakType.T)
                    return true;

                if (B == GraphemeClusterBreakType.Extend || B == GraphemeClusterBreakType.SpacingMark || A == GraphemeClusterBreakType.Prepend)
                    return true;

                return false;
            }

            static GraphemeClusterBreakType GetPropertyValue(uint cp)
            {
                var node = _graphemeClusterBreakRanges; // TODO: Replace with array for high-end devices

                for (; ; )
                {
                    if (cp < node.Value.Index)
                        node = node.Left;

                    else if (node.Value.IndexEnd < cp)
                        node = node.Right;

                    else return node.Value.Type;

                    if (node == null)
                        return GraphemeClusterBreakType.Other;
                }
            }

            static RedBlackTreeNode<GraphemeClusterBreakRange> _graphemeClusterBreakRanges;

            static GraphemeCluster()
            {
                var ranges = new int[][]
                {
                    new [] { 0, 9, 1 },
                    new [] { 10, 10, 5 },
                    new [] { 11, 12, 1 },
                    new [] { 13, 13, 2 },
                    new [] { 14, 31, 1 },
                    new [] { 127, 159, 1 },
                    new [] { 173, 173, 1 },
                    new [] { 768, 879, 3 },
                    new [] { 1155, 1161, 3 },
                    new [] { 1425, 1469, 3 },
                    new [] { 1471, 1471, 3 },
                    new [] { 1473, 1474, 3 },
                    new [] { 1476, 1477, 3 },
                    new [] { 1479, 1479, 3 },
                    new [] { 1536, 1541, 1 },
                    new [] { 1552, 1562, 3 },
                    new [] { 1564, 1564, 1 },
                    new [] { 1611, 1631, 3 },
                    new [] { 1648, 1648, 3 },
                    new [] { 1750, 1756, 3 },
                    new [] { 1757, 1757, 1 },
                    new [] { 1759, 1764, 3 },
                    new [] { 1767, 1768, 3 },
                    new [] { 1770, 1773, 3 },
                    new [] { 1807, 1807, 1 },
                    new [] { 1809, 1809, 3 },
                    new [] { 1840, 1866, 3 },
                    new [] { 1958, 1968, 3 },
                    new [] { 2027, 2035, 3 },
                    new [] { 2070, 2073, 3 },
                    new [] { 2075, 2083, 3 },
                    new [] { 2085, 2087, 3 },
                    new [] { 2089, 2093, 3 },
                    new [] { 2137, 2139, 3 },
                    new [] { 2276, 2306, 3 },
                    new [] { 2307, 2307, 10 },
                    new [] { 2362, 2362, 3 },
                    new [] { 2363, 2363, 10 },
                    new [] { 2364, 2364, 3 },
                    new [] { 2366, 2368, 10 },
                    new [] { 2369, 2376, 3 },
                    new [] { 2377, 2380, 10 },
                    new [] { 2381, 2381, 3 },
                    new [] { 2382, 2383, 10 },
                    new [] { 2385, 2391, 3 },
                    new [] { 2402, 2403, 3 },
                    new [] { 2433, 2433, 3 },
                    new [] { 2434, 2435, 10 },
                    new [] { 2492, 2492, 3 },
                    new [] { 2494, 2494, 3 },
                    new [] { 2495, 2496, 10 },
                    new [] { 2497, 2500, 3 },
                    new [] { 2503, 2504, 10 },
                    new [] { 2507, 2508, 10 },
                    new [] { 2509, 2509, 3 },
                    new [] { 2519, 2519, 3 },
                    new [] { 2530, 2531, 3 },
                    new [] { 2561, 2562, 3 },
                    new [] { 2563, 2563, 10 },
                    new [] { 2620, 2620, 3 },
                    new [] { 2622, 2624, 10 },
                    new [] { 2625, 2626, 3 },
                    new [] { 2631, 2632, 3 },
                    new [] { 2635, 2637, 3 },
                    new [] { 2641, 2641, 3 },
                    new [] { 2672, 2673, 3 },
                    new [] { 2677, 2677, 3 },
                    new [] { 2689, 2690, 3 },
                    new [] { 2691, 2691, 10 },
                    new [] { 2748, 2748, 3 },
                    new [] { 2750, 2752, 10 },
                    new [] { 2753, 2757, 3 },
                    new [] { 2759, 2760, 3 },
                    new [] { 2761, 2761, 10 },
                    new [] { 2763, 2764, 10 },
                    new [] { 2765, 2765, 3 },
                    new [] { 2786, 2787, 3 },
                    new [] { 2817, 2817, 3 },
                    new [] { 2818, 2819, 10 },
                    new [] { 2876, 2876, 3 },
                    new [] { 2878, 2879, 3 },
                    new [] { 2880, 2880, 10 },
                    new [] { 2881, 2884, 3 },
                    new [] { 2887, 2888, 10 },
                    new [] { 2891, 2892, 10 },
                    new [] { 2893, 2893, 3 },
                    new [] { 2902, 2903, 3 },
                    new [] { 2914, 2915, 3 },
                    new [] { 2946, 2946, 3 },
                    new [] { 3006, 3006, 3 },
                    new [] { 3007, 3007, 10 },
                    new [] { 3008, 3008, 3 },
                    new [] { 3009, 3010, 10 },
                    new [] { 3014, 3016, 10 },
                    new [] { 3018, 3020, 10 },
                    new [] { 3021, 3021, 3 },
                    new [] { 3031, 3031, 3 },
                    new [] { 3072, 3072, 3 },
                    new [] { 3073, 3075, 10 },
                    new [] { 3134, 3136, 3 },
                    new [] { 3137, 3140, 10 },
                    new [] { 3142, 3144, 3 },
                    new [] { 3146, 3149, 3 },
                    new [] { 3157, 3158, 3 },
                    new [] { 3170, 3171, 3 },
                    new [] { 3201, 3201, 3 },
                    new [] { 3202, 3203, 10 },
                    new [] { 3260, 3260, 3 },
                    new [] { 3262, 3262, 10 },
                    new [] { 3263, 3263, 3 },
                    new [] { 3264, 3265, 10 },
                    new [] { 3266, 3266, 3 },
                    new [] { 3267, 3268, 10 },
                    new [] { 3270, 3270, 3 },
                    new [] { 3271, 3272, 10 },
                    new [] { 3274, 3275, 10 },
                    new [] { 3276, 3277, 3 },
                    new [] { 3285, 3286, 3 },
                    new [] { 3298, 3299, 3 },
                    new [] { 3329, 3329, 3 },
                    new [] { 3330, 3331, 10 },
                    new [] { 3390, 3390, 3 },
                    new [] { 3391, 3392, 10 },
                    new [] { 3393, 3396, 3 },
                    new [] { 3398, 3400, 10 },
                    new [] { 3402, 3404, 10 },
                    new [] { 3405, 3405, 3 },
                    new [] { 3415, 3415, 3 },
                    new [] { 3426, 3427, 3 },
                    new [] { 3458, 3459, 10 },
                    new [] { 3530, 3530, 3 },
                    new [] { 3535, 3535, 3 },
                    new [] { 3536, 3537, 10 },
                    new [] { 3538, 3540, 3 },
                    new [] { 3542, 3542, 3 },
                    new [] { 3544, 3550, 10 },
                    new [] { 3551, 3551, 3 },
                    new [] { 3570, 3571, 10 },
                    new [] { 3633, 3633, 3 },
                    new [] { 3635, 3635, 10 },
                    new [] { 3636, 3642, 3 },
                    new [] { 3655, 3662, 3 },
                    new [] { 3761, 3761, 3 },
                    new [] { 3763, 3763, 10 },
                    new [] { 3764, 3769, 3 },
                    new [] { 3771, 3772, 3 },
                    new [] { 3784, 3789, 3 },
                    new [] { 3864, 3865, 3 },
                    new [] { 3893, 3893, 3 },
                    new [] { 3895, 3895, 3 },
                    new [] { 3897, 3897, 3 },
                    new [] { 3902, 3903, 10 },
                    new [] { 3953, 3966, 3 },
                    new [] { 3967, 3967, 10 },
                    new [] { 3968, 3972, 3 },
                    new [] { 3974, 3975, 3 },
                    new [] { 3981, 3991, 3 },
                    new [] { 3993, 4028, 3 },
                    new [] { 4038, 4038, 3 },
                    new [] { 4141, 4144, 3 },
                    new [] { 4145, 4145, 10 },
                    new [] { 4146, 4151, 3 },
                    new [] { 4153, 4154, 3 },
                    new [] { 4155, 4156, 10 },
                    new [] { 4157, 4158, 3 },
                    new [] { 4182, 4183, 10 },
                    new [] { 4184, 4185, 3 },
                    new [] { 4190, 4192, 3 },
                    new [] { 4209, 4212, 3 },
                    new [] { 4226, 4226, 3 },
                    new [] { 4228, 4228, 10 },
                    new [] { 4229, 4230, 3 },
                    new [] { 4237, 4237, 3 },
                    new [] { 4253, 4253, 3 },
                    new [] { 4352, 4447, 4 },
                    new [] { 4520, 4607, 8 },
                    new [] { 4957, 4959, 3 },
                    new [] { 5906, 5908, 3 },
                    new [] { 5938, 5940, 3 },
                    new [] { 5970, 5971, 3 },
                    new [] { 6002, 6003, 3 },
                    new [] { 6068, 6069, 3 },
                    new [] { 6070, 6070, 10 },
                    new [] { 6071, 6077, 3 },
                    new [] { 6078, 6085, 10 },
                    new [] { 6086, 6086, 3 },
                    new [] { 6087, 6088, 10 },
                    new [] { 6089, 6099, 3 },
                    new [] { 6109, 6109, 3 },
                    new [] { 6155, 6157, 3 },
                    new [] { 6158, 6158, 1 },
                    new [] { 6313, 6313, 3 },
                    new [] { 6432, 6434, 3 },
                    new [] { 6435, 6438, 10 },
                    new [] { 6439, 6440, 3 },
                    new [] { 6441, 6443, 10 },
                    new [] { 6448, 6449, 10 },
                    new [] { 6450, 6450, 3 },
                    new [] { 6451, 6456, 10 },
                    new [] { 6457, 6459, 3 },
                    new [] { 6581, 6583, 10 },
                    new [] { 6586, 6586, 10 },
                    new [] { 6679, 6680, 3 },
                    new [] { 6681, 6682, 10 },
                    new [] { 6683, 6683, 3 },
                    new [] { 6741, 6741, 10 },
                    new [] { 6742, 6742, 3 },
                    new [] { 6743, 6743, 10 },
                    new [] { 6744, 6750, 3 },
                    new [] { 6752, 6752, 3 },
                    new [] { 6754, 6754, 3 },
                    new [] { 6757, 6764, 3 },
                    new [] { 6765, 6770, 10 },
                    new [] { 6771, 6780, 3 },
                    new [] { 6783, 6783, 3 },
                    new [] { 6832, 6846, 3 },
                    new [] { 6912, 6915, 3 },
                    new [] { 6916, 6916, 10 },
                    new [] { 6964, 6964, 3 },
                    new [] { 6965, 6965, 10 },
                    new [] { 6966, 6970, 3 },
                    new [] { 6971, 6971, 10 },
                    new [] { 6972, 6972, 3 },
                    new [] { 6973, 6977, 10 },
                    new [] { 6978, 6978, 3 },
                    new [] { 6979, 6980, 10 },
                    new [] { 7019, 7027, 3 },
                    new [] { 7040, 7041, 3 },
                    new [] { 7042, 7042, 10 },
                    new [] { 7073, 7073, 10 },
                    new [] { 7074, 7077, 3 },
                    new [] { 7078, 7079, 10 },
                    new [] { 7080, 7081, 3 },
                    new [] { 7082, 7082, 10 },
                    new [] { 7083, 7085, 3 },
                    new [] { 7142, 7142, 3 },
                    new [] { 7143, 7143, 10 },
                    new [] { 7144, 7145, 3 },
                    new [] { 7146, 7148, 10 },
                    new [] { 7149, 7149, 3 },
                    new [] { 7150, 7150, 10 },
                    new [] { 7151, 7153, 3 },
                    new [] { 7154, 7155, 10 },
                    new [] { 7204, 7211, 10 },
                    new [] { 7212, 7219, 3 },
                    new [] { 7220, 7221, 10 },
                    new [] { 7222, 7223, 3 },
                    new [] { 7376, 7378, 3 },
                    new [] { 7380, 7392, 3 },
                    new [] { 7393, 7393, 10 },
                    new [] { 7394, 7400, 3 },
                    new [] { 7405, 7405, 3 },
                    new [] { 7410, 7411, 10 },
                    new [] { 7412, 7412, 3 },
                    new [] { 7416, 7417, 3 },
                    new [] { 7616, 7669, 3 },
                    new [] { 7676, 7679, 3 },
                    new [] { 8203, 8203, 1 },
                    new [] { 8204, 8205, 3 },
                    new [] { 8206, 8207, 1 },
                    new [] { 8232, 8238, 1 },
                    new [] { 8288, 8303, 1 },
                    new [] { 8400, 8432, 3 },
                    new [] { 11503, 11505, 3 },
                    new [] { 11647, 11647, 3 },
                    new [] { 11744, 11775, 3 },
                    new [] { 12330, 12335, 3 },
                    new [] { 12441, 12442, 3 },
                    new [] { 42607, 42610, 3 },
                    new [] { 42612, 42621, 3 },
                    new [] { 42655, 42655, 3 },
                    new [] { 42736, 42737, 3 },
                    new [] { 43010, 43010, 3 },
                    new [] { 43014, 43014, 3 },
                    new [] { 43019, 43019, 3 },
                    new [] { 43043, 43044, 10 },
                    new [] { 43045, 43046, 3 },
                    new [] { 43047, 43047, 10 },
                    new [] { 43136, 43137, 10 },
                    new [] { 43188, 43203, 10 },
                    new [] { 43204, 43204, 3 },
                    new [] { 43232, 43249, 3 },
                    new [] { 43302, 43309, 3 },
                    new [] { 43335, 43345, 3 },
                    new [] { 43346, 43347, 10 },
                    new [] { 43360, 43388, 4 },
                    new [] { 43392, 43394, 3 },
                    new [] { 43395, 43395, 10 },
                    new [] { 43443, 43443, 3 },
                    new [] { 43444, 43445, 10 },
                    new [] { 43446, 43449, 3 },
                    new [] { 43450, 43451, 10 },
                    new [] { 43452, 43452, 3 },
                    new [] { 43453, 43456, 10 },
                    new [] { 43493, 43493, 3 },
                    new [] { 43561, 43566, 3 },
                    new [] { 43567, 43568, 10 },
                    new [] { 43569, 43570, 3 },
                    new [] { 43571, 43572, 10 },
                    new [] { 43573, 43574, 3 },
                    new [] { 43587, 43587, 3 },
                    new [] { 43596, 43596, 3 },
                    new [] { 43597, 43597, 10 },
                    new [] { 43644, 43644, 3 },
                    new [] { 43696, 43696, 3 },
                    new [] { 43698, 43700, 3 },
                    new [] { 43703, 43704, 3 },
                    new [] { 43710, 43711, 3 },
                    new [] { 43713, 43713, 3 },
                    new [] { 43755, 43755, 10 },
                    new [] { 43756, 43757, 3 },
                    new [] { 43758, 43759, 10 },
                    new [] { 43765, 43765, 10 },
                    new [] { 43766, 43766, 3 },
                    new [] { 44003, 44004, 10 },
                    new [] { 44005, 44005, 3 },
                    new [] { 44006, 44007, 10 },
                    new [] { 44008, 44008, 3 },
                    new [] { 44009, 44010, 10 },
                    new [] { 44012, 44012, 10 },
                    new [] { 44013, 44013, 3 },
                    new [] { 44032, 44032, 6 },
                    new [] { 44033, 44059, 7 },
                    new [] { 44060, 44060, 6 },
                    new [] { 44061, 44087, 7 },
                    new [] { 44088, 44088, 6 },
                    new [] { 44089, 44115, 7 },
                    new [] { 44116, 44116, 6 },
                    new [] { 44117, 44143, 7 },
                    new [] { 44144, 44144, 6 },
                    new [] { 44145, 44171, 7 },
                    new [] { 44172, 44172, 6 },
                    new [] { 44173, 44199, 7 },
                    new [] { 44200, 44200, 6 },
                    new [] { 44201, 44227, 7 },
                    new [] { 44228, 44228, 6 },
                    new [] { 44229, 44255, 7 },
                    new [] { 44256, 44256, 6 },
                    new [] { 44257, 44283, 7 },
                    new [] { 44284, 44284, 6 },
                    new [] { 44285, 44311, 7 },
                    new [] { 44312, 44312, 6 },
                    new [] { 44313, 44339, 7 },
                    new [] { 44340, 44340, 6 },
                    new [] { 44341, 44367, 7 },
                    new [] { 44368, 44368, 6 },
                    new [] { 44369, 44395, 7 },
                    new [] { 44396, 44396, 6 },
                    new [] { 44397, 44423, 7 },
                    new [] { 44424, 44424, 6 },
                    new [] { 44425, 44451, 7 },
                    new [] { 44452, 44452, 6 },
                    new [] { 44453, 44479, 7 },
                    new [] { 44480, 44480, 6 },
                    new [] { 44481, 44507, 7 },
                    new [] { 44508, 44508, 6 },
                    new [] { 44509, 44535, 7 },
                    new [] { 44536, 44536, 6 },
                    new [] { 44537, 44563, 7 },
                    new [] { 44564, 44564, 6 },
                    new [] { 44565, 44591, 7 },
                    new [] { 44592, 44592, 6 },
                    new [] { 44593, 44619, 7 },
                    new [] { 44620, 44620, 6 },
                    new [] { 44621, 44647, 7 },
                    new [] { 44648, 44648, 6 },
                    new [] { 44649, 44675, 7 },
                    new [] { 44676, 44676, 6 },
                    new [] { 44677, 44703, 7 },
                    new [] { 44704, 44704, 6 },
                    new [] { 44705, 44731, 7 },
                    new [] { 44732, 44732, 6 },
                    new [] { 44733, 44759, 7 },
                    new [] { 44760, 44760, 6 },
                    new [] { 44761, 44787, 7 },
                    new [] { 44788, 44788, 6 },
                    new [] { 44789, 44815, 7 },
                    new [] { 44816, 44816, 6 },
                    new [] { 44817, 44843, 7 },
                    new [] { 44844, 44844, 6 },
                    new [] { 44845, 44871, 7 },
                    new [] { 44872, 44872, 6 },
                    new [] { 44873, 44899, 7 },
                    new [] { 44900, 44900, 6 },
                    new [] { 44901, 44927, 7 },
                    new [] { 44928, 44928, 6 },
                    new [] { 44929, 44955, 7 },
                    new [] { 44956, 44956, 6 },
                    new [] { 44957, 44983, 7 },
                    new [] { 44984, 44984, 6 },
                    new [] { 44985, 45011, 7 },
                    new [] { 45012, 45012, 6 },
                    new [] { 45013, 45039, 7 },
                    new [] { 45040, 45040, 6 },
                    new [] { 45041, 45067, 7 },
                    new [] { 45068, 45068, 6 },
                    new [] { 45069, 45095, 7 },
                    new [] { 45096, 45096, 6 },
                    new [] { 45097, 45123, 7 },
                    new [] { 45124, 45124, 6 },
                    new [] { 45125, 45151, 7 },
                    new [] { 45152, 45152, 6 },
                    new [] { 45153, 45179, 7 },
                    new [] { 45180, 45180, 6 },
                    new [] { 45181, 45207, 7 },
                    new [] { 45208, 45208, 6 },
                    new [] { 45209, 45235, 7 },
                    new [] { 45236, 45236, 6 },
                    new [] { 45237, 45263, 7 },
                    new [] { 45264, 45264, 6 },
                    new [] { 45265, 45291, 7 },
                    new [] { 45292, 45292, 6 },
                    new [] { 45293, 45319, 7 },
                    new [] { 45320, 45320, 6 },
                    new [] { 45321, 45347, 7 },
                    new [] { 45348, 45348, 6 },
                    new [] { 45349, 45375, 7 },
                    new [] { 45376, 45376, 6 },
                    new [] { 45377, 45403, 7 },
                    new [] { 45404, 45404, 6 },
                    new [] { 45405, 45431, 7 },
                    new [] { 45432, 45432, 6 },
                    new [] { 45433, 45459, 7 },
                    new [] { 45460, 45460, 6 },
                    new [] { 45461, 45487, 7 },
                    new [] { 45488, 45488, 6 },
                    new [] { 45489, 45515, 7 },
                    new [] { 45516, 45516, 6 },
                    new [] { 45517, 45543, 7 },
                    new [] { 45544, 45544, 6 },
                    new [] { 45545, 45571, 7 },
                    new [] { 45572, 45572, 6 },
                    new [] { 45573, 45599, 7 },
                    new [] { 45600, 45600, 6 },
                    new [] { 45601, 45627, 7 },
                    new [] { 45628, 45628, 6 },
                    new [] { 45629, 45655, 7 },
                    new [] { 45656, 45656, 6 },
                    new [] { 45657, 45683, 7 },
                    new [] { 45684, 45684, 6 },
                    new [] { 45685, 45711, 7 },
                    new [] { 45712, 45712, 6 },
                    new [] { 45713, 45739, 7 },
                    new [] { 45740, 45740, 6 },
                    new [] { 45741, 45767, 7 },
                    new [] { 45768, 45768, 6 },
                    new [] { 45769, 45795, 7 },
                    new [] { 45796, 45796, 6 },
                    new [] { 45797, 45823, 7 },
                    new [] { 45824, 45824, 6 },
                    new [] { 45825, 45851, 7 },
                    new [] { 45852, 45852, 6 },
                    new [] { 45853, 45879, 7 },
                    new [] { 45880, 45880, 6 },
                    new [] { 45881, 45907, 7 },
                    new [] { 45908, 45908, 6 },
                    new [] { 45909, 45935, 7 },
                    new [] { 45936, 45936, 6 },
                    new [] { 45937, 45963, 7 },
                    new [] { 45964, 45964, 6 },
                    new [] { 45965, 45991, 7 },
                    new [] { 45992, 45992, 6 },
                    new [] { 45993, 46019, 7 },
                    new [] { 46020, 46020, 6 },
                    new [] { 46021, 46047, 7 },
                    new [] { 46048, 46048, 6 },
                    new [] { 46049, 46075, 7 },
                    new [] { 46076, 46076, 6 },
                    new [] { 46077, 46103, 7 },
                    new [] { 46104, 46104, 6 },
                    new [] { 46105, 46131, 7 },
                    new [] { 46132, 46132, 6 },
                    new [] { 46133, 46159, 7 },
                    new [] { 46160, 46160, 6 },
                    new [] { 46161, 46187, 7 },
                    new [] { 46188, 46188, 6 },
                    new [] { 46189, 46215, 7 },
                    new [] { 46216, 46216, 6 },
                    new [] { 46217, 46243, 7 },
                    new [] { 46244, 46244, 6 },
                    new [] { 46245, 46271, 7 },
                    new [] { 46272, 46272, 6 },
                    new [] { 46273, 46299, 7 },
                    new [] { 46300, 46300, 6 },
                    new [] { 46301, 46327, 7 },
                    new [] { 46328, 46328, 6 },
                    new [] { 46329, 46355, 7 },
                    new [] { 46356, 46356, 6 },
                    new [] { 46357, 46383, 7 },
                    new [] { 46384, 46384, 6 },
                    new [] { 46385, 46411, 7 },
                    new [] { 46412, 46412, 6 },
                    new [] { 46413, 46439, 7 },
                    new [] { 46440, 46440, 6 },
                    new [] { 46441, 46467, 7 },
                    new [] { 46468, 46468, 6 },
                    new [] { 46469, 46495, 7 },
                    new [] { 46496, 46496, 6 },
                    new [] { 46497, 46523, 7 },
                    new [] { 46524, 46524, 6 },
                    new [] { 46525, 46551, 7 },
                    new [] { 46552, 46552, 6 },
                    new [] { 46553, 46579, 7 },
                    new [] { 46580, 46580, 6 },
                    new [] { 46581, 46607, 7 },
                    new [] { 46608, 46608, 6 },
                    new [] { 46609, 46635, 7 },
                    new [] { 46636, 46636, 6 },
                    new [] { 46637, 46663, 7 },
                    new [] { 46664, 46664, 6 },
                    new [] { 46665, 46691, 7 },
                    new [] { 46692, 46692, 6 },
                    new [] { 46693, 46719, 7 },
                    new [] { 46720, 46720, 6 },
                    new [] { 46721, 46747, 7 },
                    new [] { 46748, 46748, 6 },
                    new [] { 46749, 46775, 7 },
                    new [] { 46776, 46776, 6 },
                    new [] { 46777, 46803, 7 },
                    new [] { 46804, 46804, 6 },
                    new [] { 46805, 46831, 7 },
                    new [] { 46832, 46832, 6 },
                    new [] { 46833, 46859, 7 },
                    new [] { 46860, 46860, 6 },
                    new [] { 46861, 46887, 7 },
                    new [] { 46888, 46888, 6 },
                    new [] { 46889, 46915, 7 },
                    new [] { 46916, 46916, 6 },
                    new [] { 46917, 46943, 7 },
                    new [] { 46944, 46944, 6 },
                    new [] { 46945, 46971, 7 },
                    new [] { 46972, 46972, 6 },
                    new [] { 46973, 46999, 7 },
                    new [] { 47000, 47000, 6 },
                    new [] { 47001, 47027, 7 },
                    new [] { 47028, 47028, 6 },
                    new [] { 47029, 47055, 7 },
                    new [] { 47056, 47056, 6 },
                    new [] { 47057, 47083, 7 },
                    new [] { 47084, 47084, 6 },
                    new [] { 47085, 47111, 7 },
                    new [] { 47112, 47112, 6 },
                    new [] { 47113, 47139, 7 },
                    new [] { 47140, 47140, 6 },
                    new [] { 47141, 47167, 7 },
                    new [] { 47168, 47168, 6 },
                    new [] { 47169, 47195, 7 },
                    new [] { 47196, 47196, 6 },
                    new [] { 47197, 47223, 7 },
                    new [] { 47224, 47224, 6 },
                    new [] { 47225, 47251, 7 },
                    new [] { 47252, 47252, 6 },
                    new [] { 47253, 47279, 7 },
                    new [] { 47280, 47280, 6 },
                    new [] { 47281, 47307, 7 },
                    new [] { 47308, 47308, 6 },
                    new [] { 47309, 47335, 7 },
                    new [] { 47336, 47336, 6 },
                    new [] { 47337, 47363, 7 },
                    new [] { 47364, 47364, 6 },
                    new [] { 47365, 47391, 7 },
                    new [] { 47392, 47392, 6 },
                    new [] { 47393, 47419, 7 },
                    new [] { 47420, 47420, 6 },
                    new [] { 47421, 47447, 7 },
                    new [] { 47448, 47448, 6 },
                    new [] { 47449, 47475, 7 },
                    new [] { 47476, 47476, 6 },
                    new [] { 47477, 47503, 7 },
                    new [] { 47504, 47504, 6 },
                    new [] { 47505, 47531, 7 },
                    new [] { 47532, 47532, 6 },
                    new [] { 47533, 47559, 7 },
                    new [] { 47560, 47560, 6 },
                    new [] { 47561, 47587, 7 },
                    new [] { 47588, 47588, 6 },
                    new [] { 47589, 47615, 7 },
                    new [] { 47616, 47616, 6 },
                    new [] { 47617, 47643, 7 },
                    new [] { 47644, 47644, 6 },
                    new [] { 47645, 47671, 7 },
                    new [] { 47672, 47672, 6 },
                    new [] { 47673, 47699, 7 },
                    new [] { 47700, 47700, 6 },
                    new [] { 47701, 47727, 7 },
                    new [] { 47728, 47728, 6 },
                    new [] { 47729, 47755, 7 },
                    new [] { 47756, 47756, 6 },
                    new [] { 47757, 47783, 7 },
                    new [] { 47784, 47784, 6 },
                    new [] { 47785, 47811, 7 },
                    new [] { 47812, 47812, 6 },
                    new [] { 47813, 47839, 7 },
                    new [] { 47840, 47840, 6 },
                    new [] { 47841, 47867, 7 },
                    new [] { 47868, 47868, 6 },
                    new [] { 47869, 47895, 7 },
                    new [] { 47896, 47896, 6 },
                    new [] { 47897, 47923, 7 },
                    new [] { 47924, 47924, 6 },
                    new [] { 47925, 47951, 7 },
                    new [] { 47952, 47952, 6 },
                    new [] { 47953, 47979, 7 },
                    new [] { 47980, 47980, 6 },
                    new [] { 47981, 48007, 7 },
                    new [] { 48008, 48008, 6 },
                    new [] { 48009, 48035, 7 },
                    new [] { 48036, 48036, 6 },
                    new [] { 48037, 48063, 7 },
                    new [] { 48064, 48064, 6 },
                    new [] { 48065, 48091, 7 },
                    new [] { 48092, 48092, 6 },
                    new [] { 48093, 48119, 7 },
                    new [] { 48120, 48120, 6 },
                    new [] { 48121, 48147, 7 },
                    new [] { 48148, 48148, 6 },
                    new [] { 48149, 48175, 7 },
                    new [] { 48176, 48176, 6 },
                    new [] { 48177, 48203, 7 },
                    new [] { 48204, 48204, 6 },
                    new [] { 48205, 48231, 7 },
                    new [] { 48232, 48232, 6 },
                    new [] { 48233, 48259, 7 },
                    new [] { 48260, 48260, 6 },
                    new [] { 48261, 48287, 7 },
                    new [] { 48288, 48288, 6 },
                    new [] { 48289, 48315, 7 },
                    new [] { 48316, 48316, 6 },
                    new [] { 48317, 48343, 7 },
                    new [] { 48344, 48344, 6 },
                    new [] { 48345, 48371, 7 },
                    new [] { 48372, 48372, 6 },
                    new [] { 48373, 48399, 7 },
                    new [] { 48400, 48400, 6 },
                    new [] { 48401, 48427, 7 },
                    new [] { 48428, 48428, 6 },
                    new [] { 48429, 48455, 7 },
                    new [] { 48456, 48456, 6 },
                    new [] { 48457, 48483, 7 },
                    new [] { 48484, 48484, 6 },
                    new [] { 48485, 48511, 7 },
                    new [] { 48512, 48512, 6 },
                    new [] { 48513, 48539, 7 },
                    new [] { 48540, 48540, 6 },
                    new [] { 48541, 48567, 7 },
                    new [] { 48568, 48568, 6 },
                    new [] { 48569, 48595, 7 },
                    new [] { 48596, 48596, 6 },
                    new [] { 48597, 48623, 7 },
                    new [] { 48624, 48624, 6 },
                    new [] { 48625, 48651, 7 },
                    new [] { 48652, 48652, 6 },
                    new [] { 48653, 48679, 7 },
                    new [] { 48680, 48680, 6 },
                    new [] { 48681, 48707, 7 },
                    new [] { 48708, 48708, 6 },
                    new [] { 48709, 48735, 7 },
                    new [] { 48736, 48736, 6 },
                    new [] { 48737, 48763, 7 },
                    new [] { 48764, 48764, 6 },
                    new [] { 48765, 48791, 7 },
                    new [] { 48792, 48792, 6 },
                    new [] { 48793, 48819, 7 },
                    new [] { 48820, 48820, 6 },
                    new [] { 48821, 48847, 7 },
                    new [] { 48848, 48848, 6 },
                    new [] { 48849, 48875, 7 },
                    new [] { 48876, 48876, 6 },
                    new [] { 48877, 48903, 7 },
                    new [] { 48904, 48904, 6 },
                    new [] { 48905, 48931, 7 },
                    new [] { 48932, 48932, 6 },
                    new [] { 48933, 48959, 7 },
                    new [] { 48960, 48960, 6 },
                    new [] { 48961, 48987, 7 },
                    new [] { 48988, 48988, 6 },
                    new [] { 48989, 49015, 7 },
                    new [] { 49016, 49016, 6 },
                    new [] { 49017, 49043, 7 },
                    new [] { 49044, 49044, 6 },
                    new [] { 49045, 49071, 7 },
                    new [] { 49072, 49072, 6 },
                    new [] { 49073, 49099, 7 },
                    new [] { 49100, 49100, 6 },
                    new [] { 49101, 49127, 7 },
                    new [] { 49128, 49128, 6 },
                    new [] { 49129, 49155, 7 },
                    new [] { 49156, 49156, 6 },
                    new [] { 49157, 49183, 7 },
                    new [] { 49184, 49184, 6 },
                    new [] { 49185, 49211, 7 },
                    new [] { 49212, 49212, 6 },
                    new [] { 49213, 49239, 7 },
                    new [] { 49240, 49240, 6 },
                    new [] { 49241, 49267, 7 },
                    new [] { 49268, 49268, 6 },
                    new [] { 49269, 49295, 7 },
                    new [] { 49296, 49296, 6 },
                    new [] { 49297, 49323, 7 },
                    new [] { 49324, 49324, 6 },
                    new [] { 49325, 49351, 7 },
                    new [] { 49352, 49352, 6 },
                    new [] { 49353, 49379, 7 },
                    new [] { 49380, 49380, 6 },
                    new [] { 49381, 49407, 7 },
                    new [] { 49408, 49408, 6 },
                    new [] { 49409, 49435, 7 },
                    new [] { 49436, 49436, 6 },
                    new [] { 49437, 49463, 7 },
                    new [] { 49464, 49464, 6 },
                    new [] { 49465, 49491, 7 },
                    new [] { 49492, 49492, 6 },
                    new [] { 49493, 49519, 7 },
                    new [] { 49520, 49520, 6 },
                    new [] { 49521, 49547, 7 },
                    new [] { 49548, 49548, 6 },
                    new [] { 49549, 49575, 7 },
                    new [] { 49576, 49576, 6 },
                    new [] { 49577, 49603, 7 },
                    new [] { 49604, 49604, 6 },
                    new [] { 49605, 49631, 7 },
                    new [] { 49632, 49632, 6 },
                    new [] { 49633, 49659, 7 },
                    new [] { 49660, 49660, 6 },
                    new [] { 49661, 49687, 7 },
                    new [] { 49688, 49688, 6 },
                    new [] { 49689, 49715, 7 },
                    new [] { 49716, 49716, 6 },
                    new [] { 49717, 49743, 7 },
                    new [] { 49744, 49744, 6 },
                    new [] { 49745, 49771, 7 },
                    new [] { 49772, 49772, 6 },
                    new [] { 49773, 49799, 7 },
                    new [] { 49800, 49800, 6 },
                    new [] { 49801, 49827, 7 },
                    new [] { 49828, 49828, 6 },
                    new [] { 49829, 49855, 7 },
                    new [] { 49856, 49856, 6 },
                    new [] { 49857, 49883, 7 },
                    new [] { 49884, 49884, 6 },
                    new [] { 49885, 49911, 7 },
                    new [] { 49912, 49912, 6 },
                    new [] { 49913, 49939, 7 },
                    new [] { 49940, 49940, 6 },
                    new [] { 49941, 49967, 7 },
                    new [] { 49968, 49968, 6 },
                    new [] { 49969, 49995, 7 },
                    new [] { 49996, 49996, 6 },
                    new [] { 49997, 50023, 7 },
                    new [] { 50024, 50024, 6 },
                    new [] { 50025, 50051, 7 },
                    new [] { 50052, 50052, 6 },
                    new [] { 50053, 50079, 7 },
                    new [] { 50080, 50080, 6 },
                    new [] { 50081, 50107, 7 },
                    new [] { 50108, 50108, 6 },
                    new [] { 50109, 50135, 7 },
                    new [] { 50136, 50136, 6 },
                    new [] { 50137, 50163, 7 },
                    new [] { 50164, 50164, 6 },
                    new [] { 50165, 50191, 7 },
                    new [] { 50192, 50192, 6 },
                    new [] { 50193, 50219, 7 },
                    new [] { 50220, 50220, 6 },
                    new [] { 50221, 50247, 7 },
                    new [] { 50248, 50248, 6 },
                    new [] { 50249, 50275, 7 },
                    new [] { 50276, 50276, 6 },
                    new [] { 50277, 50303, 7 },
                    new [] { 50304, 50304, 6 },
                    new [] { 50305, 50331, 7 },
                    new [] { 50332, 50332, 6 },
                    new [] { 50333, 50359, 7 },
                    new [] { 50360, 50360, 6 },
                    new [] { 50361, 50387, 7 },
                    new [] { 50388, 50388, 6 },
                    new [] { 50389, 50415, 7 },
                    new [] { 50416, 50416, 6 },
                    new [] { 50417, 50443, 7 },
                    new [] { 50444, 50444, 6 },
                    new [] { 50445, 50471, 7 },
                    new [] { 50472, 50472, 6 },
                    new [] { 50473, 50499, 7 },
                    new [] { 50500, 50500, 6 },
                    new [] { 50501, 50527, 7 },
                    new [] { 50528, 50528, 6 },
                    new [] { 50529, 50555, 7 },
                    new [] { 50556, 50556, 6 },
                    new [] { 50557, 50583, 7 },
                    new [] { 50584, 50584, 6 },
                    new [] { 50585, 50611, 7 },
                    new [] { 50612, 50612, 6 },
                    new [] { 50613, 50639, 7 },
                    new [] { 50640, 50640, 6 },
                    new [] { 50641, 50667, 7 },
                    new [] { 50668, 50668, 6 },
                    new [] { 50669, 50695, 7 },
                    new [] { 50696, 50696, 6 },
                    new [] { 50697, 50723, 7 },
                    new [] { 50724, 50724, 6 },
                    new [] { 50725, 50751, 7 },
                    new [] { 50752, 50752, 6 },
                    new [] { 50753, 50779, 7 },
                    new [] { 50780, 50780, 6 },
                    new [] { 50781, 50807, 7 },
                    new [] { 50808, 50808, 6 },
                    new [] { 50809, 50835, 7 },
                    new [] { 50836, 50836, 6 },
                    new [] { 50837, 50863, 7 },
                    new [] { 50864, 50864, 6 },
                    new [] { 50865, 50891, 7 },
                    new [] { 50892, 50892, 6 },
                    new [] { 50893, 50919, 7 },
                    new [] { 50920, 50920, 6 },
                    new [] { 50921, 50947, 7 },
                    new [] { 50948, 50948, 6 },
                    new [] { 50949, 50975, 7 },
                    new [] { 50976, 50976, 6 },
                    new [] { 50977, 51003, 7 },
                    new [] { 51004, 51004, 6 },
                    new [] { 51005, 51031, 7 },
                    new [] { 51032, 51032, 6 },
                    new [] { 51033, 51059, 7 },
                    new [] { 51060, 51060, 6 },
                    new [] { 51061, 51087, 7 },
                    new [] { 51088, 51088, 6 },
                    new [] { 51089, 51115, 7 },
                    new [] { 51116, 51116, 6 },
                    new [] { 51117, 51143, 7 },
                    new [] { 51144, 51144, 6 },
                    new [] { 51145, 51171, 7 },
                    new [] { 51172, 51172, 6 },
                    new [] { 51173, 51199, 7 },
                    new [] { 51200, 51200, 6 },
                    new [] { 51201, 51227, 7 },
                    new [] { 51228, 51228, 6 },
                    new [] { 51229, 51255, 7 },
                    new [] { 51256, 51256, 6 },
                    new [] { 51257, 51283, 7 },
                    new [] { 51284, 51284, 6 },
                    new [] { 51285, 51311, 7 },
                    new [] { 51312, 51312, 6 },
                    new [] { 51313, 51339, 7 },
                    new [] { 51340, 51340, 6 },
                    new [] { 51341, 51367, 7 },
                    new [] { 51368, 51368, 6 },
                    new [] { 51369, 51395, 7 },
                    new [] { 51396, 51396, 6 },
                    new [] { 51397, 51423, 7 },
                    new [] { 51424, 51424, 6 },
                    new [] { 51425, 51451, 7 },
                    new [] { 51452, 51452, 6 },
                    new [] { 51453, 51479, 7 },
                    new [] { 51480, 51480, 6 },
                    new [] { 51481, 51507, 7 },
                    new [] { 51508, 51508, 6 },
                    new [] { 51509, 51535, 7 },
                    new [] { 51536, 51536, 6 },
                    new [] { 51537, 51563, 7 },
                    new [] { 51564, 51564, 6 },
                    new [] { 51565, 51591, 7 },
                    new [] { 51592, 51592, 6 },
                    new [] { 51593, 51619, 7 },
                    new [] { 51620, 51620, 6 },
                    new [] { 51621, 51647, 7 },
                    new [] { 51648, 51648, 6 },
                    new [] { 51649, 51675, 7 },
                    new [] { 51676, 51676, 6 },
                    new [] { 51677, 51703, 7 },
                    new [] { 51704, 51704, 6 },
                    new [] { 51705, 51731, 7 },
                    new [] { 51732, 51732, 6 },
                    new [] { 51733, 51759, 7 },
                    new [] { 51760, 51760, 6 },
                    new [] { 51761, 51787, 7 },
                    new [] { 51788, 51788, 6 },
                    new [] { 51789, 51815, 7 },
                    new [] { 51816, 51816, 6 },
                    new [] { 51817, 51843, 7 },
                    new [] { 51844, 51844, 6 },
                    new [] { 51845, 51871, 7 },
                    new [] { 51872, 51872, 6 },
                    new [] { 51873, 51899, 7 },
                    new [] { 51900, 51900, 6 },
                    new [] { 51901, 51927, 7 },
                    new [] { 51928, 51928, 6 },
                    new [] { 51929, 51955, 7 },
                    new [] { 51956, 51956, 6 },
                    new [] { 51957, 51983, 7 },
                    new [] { 51984, 51984, 6 },
                    new [] { 51985, 52011, 7 },
                    new [] { 52012, 52012, 6 },
                    new [] { 52013, 52039, 7 },
                    new [] { 52040, 52040, 6 },
                    new [] { 52041, 52067, 7 },
                    new [] { 52068, 52068, 6 },
                    new [] { 52069, 52095, 7 },
                    new [] { 52096, 52096, 6 },
                    new [] { 52097, 52123, 7 },
                    new [] { 52124, 52124, 6 },
                    new [] { 52125, 52151, 7 },
                    new [] { 52152, 52152, 6 },
                    new [] { 52153, 52179, 7 },
                    new [] { 52180, 52180, 6 },
                    new [] { 52181, 52207, 7 },
                    new [] { 52208, 52208, 6 },
                    new [] { 52209, 52235, 7 },
                    new [] { 52236, 52236, 6 },
                    new [] { 52237, 52263, 7 },
                    new [] { 52264, 52264, 6 },
                    new [] { 52265, 52291, 7 },
                    new [] { 52292, 52292, 6 },
                    new [] { 52293, 52319, 7 },
                    new [] { 52320, 52320, 6 },
                    new [] { 52321, 52347, 7 },
                    new [] { 52348, 52348, 6 },
                    new [] { 52349, 52375, 7 },
                    new [] { 52376, 52376, 6 },
                    new [] { 52377, 52403, 7 },
                    new [] { 52404, 52404, 6 },
                    new [] { 52405, 52431, 7 },
                    new [] { 52432, 52432, 6 },
                    new [] { 52433, 52459, 7 },
                    new [] { 52460, 52460, 6 },
                    new [] { 52461, 52487, 7 },
                    new [] { 52488, 52488, 6 },
                    new [] { 52489, 52515, 7 },
                    new [] { 52516, 52516, 6 },
                    new [] { 52517, 52543, 7 },
                    new [] { 52544, 52544, 6 },
                    new [] { 52545, 52571, 7 },
                    new [] { 52572, 52572, 6 },
                    new [] { 52573, 52599, 7 },
                    new [] { 52600, 52600, 6 },
                    new [] { 52601, 52627, 7 },
                    new [] { 52628, 52628, 6 },
                    new [] { 52629, 52655, 7 },
                    new [] { 52656, 52656, 6 },
                    new [] { 52657, 52683, 7 },
                    new [] { 52684, 52684, 6 },
                    new [] { 52685, 52711, 7 },
                    new [] { 52712, 52712, 6 },
                    new [] { 52713, 52739, 7 },
                    new [] { 52740, 52740, 6 },
                    new [] { 52741, 52767, 7 },
                    new [] { 52768, 52768, 6 },
                    new [] { 52769, 52795, 7 },
                    new [] { 52796, 52796, 6 },
                    new [] { 52797, 52823, 7 },
                    new [] { 52824, 52824, 6 },
                    new [] { 52825, 52851, 7 },
                    new [] { 52852, 52852, 6 },
                    new [] { 52853, 52879, 7 },
                    new [] { 52880, 52880, 6 },
                    new [] { 52881, 52907, 7 },
                    new [] { 52908, 52908, 6 },
                    new [] { 52909, 52935, 7 },
                    new [] { 52936, 52936, 6 },
                    new [] { 52937, 52963, 7 },
                    new [] { 52964, 52964, 6 },
                    new [] { 52965, 52991, 7 },
                    new [] { 52992, 52992, 6 },
                    new [] { 52993, 53019, 7 },
                    new [] { 53020, 53020, 6 },
                    new [] { 53021, 53047, 7 },
                    new [] { 53048, 53048, 6 },
                    new [] { 53049, 53075, 7 },
                    new [] { 53076, 53076, 6 },
                    new [] { 53077, 53103, 7 },
                    new [] { 53104, 53104, 6 },
                    new [] { 53105, 53131, 7 },
                    new [] { 53132, 53132, 6 },
                    new [] { 53133, 53159, 7 },
                    new [] { 53160, 53160, 6 },
                    new [] { 53161, 53187, 7 },
                    new [] { 53188, 53188, 6 },
                    new [] { 53189, 53215, 7 },
                    new [] { 53216, 53216, 6 },
                    new [] { 53217, 53243, 7 },
                    new [] { 53244, 53244, 6 },
                    new [] { 53245, 53271, 7 },
                    new [] { 53272, 53272, 6 },
                    new [] { 53273, 53299, 7 },
                    new [] { 53300, 53300, 6 },
                    new [] { 53301, 53327, 7 },
                    new [] { 53328, 53328, 6 },
                    new [] { 53329, 53355, 7 },
                    new [] { 53356, 53356, 6 },
                    new [] { 53357, 53383, 7 },
                    new [] { 53384, 53384, 6 },
                    new [] { 53385, 53411, 7 },
                    new [] { 53412, 53412, 6 },
                    new [] { 53413, 53439, 7 },
                    new [] { 53440, 53440, 6 },
                    new [] { 53441, 53467, 7 },
                    new [] { 53468, 53468, 6 },
                    new [] { 53469, 53495, 7 },
                    new [] { 53496, 53496, 6 },
                    new [] { 53497, 53523, 7 },
                    new [] { 53524, 53524, 6 },
                    new [] { 53525, 53551, 7 },
                    new [] { 53552, 53552, 6 },
                    new [] { 53553, 53579, 7 },
                    new [] { 53580, 53580, 6 },
                    new [] { 53581, 53607, 7 },
                    new [] { 53608, 53608, 6 },
                    new [] { 53609, 53635, 7 },
                    new [] { 53636, 53636, 6 },
                    new [] { 53637, 53663, 7 },
                    new [] { 53664, 53664, 6 },
                    new [] { 53665, 53691, 7 },
                    new [] { 53692, 53692, 6 },
                    new [] { 53693, 53719, 7 },
                    new [] { 53720, 53720, 6 },
                    new [] { 53721, 53747, 7 },
                    new [] { 53748, 53748, 6 },
                    new [] { 53749, 53775, 7 },
                    new [] { 53776, 53776, 6 },
                    new [] { 53777, 53803, 7 },
                    new [] { 53804, 53804, 6 },
                    new [] { 53805, 53831, 7 },
                    new [] { 53832, 53832, 6 },
                    new [] { 53833, 53859, 7 },
                    new [] { 53860, 53860, 6 },
                    new [] { 53861, 53887, 7 },
                    new [] { 53888, 53888, 6 },
                    new [] { 53889, 53915, 7 },
                    new [] { 53916, 53916, 6 },
                    new [] { 53917, 53943, 7 },
                    new [] { 53944, 53944, 6 },
                    new [] { 53945, 53971, 7 },
                    new [] { 53972, 53972, 6 },
                    new [] { 53973, 53999, 7 },
                    new [] { 54000, 54000, 6 },
                    new [] { 54001, 54027, 7 },
                    new [] { 54028, 54028, 6 },
                    new [] { 54029, 54055, 7 },
                    new [] { 54056, 54056, 6 },
                    new [] { 54057, 54083, 7 },
                    new [] { 54084, 54084, 6 },
                    new [] { 54085, 54111, 7 },
                    new [] { 54112, 54112, 6 },
                    new [] { 54113, 54139, 7 },
                    new [] { 54140, 54140, 6 },
                    new [] { 54141, 54167, 7 },
                    new [] { 54168, 54168, 6 },
                    new [] { 54169, 54195, 7 },
                    new [] { 54196, 54196, 6 },
                    new [] { 54197, 54223, 7 },
                    new [] { 54224, 54224, 6 },
                    new [] { 54225, 54251, 7 },
                    new [] { 54252, 54252, 6 },
                    new [] { 54253, 54279, 7 },
                    new [] { 54280, 54280, 6 },
                    new [] { 54281, 54307, 7 },
                    new [] { 54308, 54308, 6 },
                    new [] { 54309, 54335, 7 },
                    new [] { 54336, 54336, 6 },
                    new [] { 54337, 54363, 7 },
                    new [] { 54364, 54364, 6 },
                    new [] { 54365, 54391, 7 },
                    new [] { 54392, 54392, 6 },
                    new [] { 54393, 54419, 7 },
                    new [] { 54420, 54420, 6 },
                    new [] { 54421, 54447, 7 },
                    new [] { 54448, 54448, 6 },
                    new [] { 54449, 54475, 7 },
                    new [] { 54476, 54476, 6 },
                    new [] { 54477, 54503, 7 },
                    new [] { 54504, 54504, 6 },
                    new [] { 54505, 54531, 7 },
                    new [] { 54532, 54532, 6 },
                    new [] { 54533, 54559, 7 },
                    new [] { 54560, 54560, 6 },
                    new [] { 54561, 54587, 7 },
                    new [] { 54588, 54588, 6 },
                    new [] { 54589, 54615, 7 },
                    new [] { 54616, 54616, 6 },
                    new [] { 54617, 54643, 7 },
                    new [] { 54644, 54644, 6 },
                    new [] { 54645, 54671, 7 },
                    new [] { 54672, 54672, 6 },
                    new [] { 54673, 54699, 7 },
                    new [] { 54700, 54700, 6 },
                    new [] { 54701, 54727, 7 },
                    new [] { 54728, 54728, 6 },
                    new [] { 54729, 54755, 7 },
                    new [] { 54756, 54756, 6 },
                    new [] { 54757, 54783, 7 },
                    new [] { 54784, 54784, 6 },
                    new [] { 54785, 54811, 7 },
                    new [] { 54812, 54812, 6 },
                    new [] { 54813, 54839, 7 },
                    new [] { 54840, 54840, 6 },
                    new [] { 54841, 54867, 7 },
                    new [] { 54868, 54868, 6 },
                    new [] { 54869, 54895, 7 },
                    new [] { 54896, 54896, 6 },
                    new [] { 54897, 54923, 7 },
                    new [] { 54924, 54924, 6 },
                    new [] { 54925, 54951, 7 },
                    new [] { 54952, 54952, 6 },
                    new [] { 54953, 54979, 7 },
                    new [] { 54980, 54980, 6 },
                    new [] { 54981, 55007, 7 },
                    new [] { 55008, 55008, 6 },
                    new [] { 55009, 55035, 7 },
                    new [] { 55036, 55036, 6 },
                    new [] { 55037, 55063, 7 },
                    new [] { 55064, 55064, 6 },
                    new [] { 55065, 55091, 7 },
                    new [] { 55092, 55092, 6 },
                    new [] { 55093, 55119, 7 },
                    new [] { 55120, 55120, 6 },
                    new [] { 55121, 55147, 7 },
                    new [] { 55148, 55148, 6 },
                    new [] { 55149, 55175, 7 },
                    new [] { 55176, 55176, 6 },
                    new [] { 55177, 55203, 7 },
                    new [] { 55243, 55291, 8 },
                    new [] { 55296, 57343, 1 },
                    new [] { 64286, 64286, 3 },
                    new [] { 65024, 65039, 3 },
                    new [] { 65056, 65069, 3 },
                    new [] { 65279, 65279, 1 },
                    new [] { 65438, 65439, 3 },
                    new [] { 65520, 65531, 1 },
                    new [] { 66045, 66045, 3 },
                    new [] { 66272, 66272, 3 },
                    new [] { 66422, 66426, 3 },
                    new [] { 68097, 68099, 3 },
                    new [] { 68101, 68102, 3 },
                    new [] { 68108, 68111, 3 },
                    new [] { 68152, 68154, 3 },
                    new [] { 68159, 68159, 3 },
                    new [] { 68325, 68326, 3 },
                    new [] { 69632, 69632, 10 },
                    new [] { 69633, 69633, 3 },
                    new [] { 69634, 69634, 10 },
                    new [] { 69688, 69702, 3 },
                    new [] { 69759, 69761, 3 },
                    new [] { 69762, 69762, 10 },
                    new [] { 69808, 69810, 10 },
                    new [] { 69811, 69814, 3 },
                    new [] { 69815, 69816, 10 },
                    new [] { 69817, 69818, 3 },
                    new [] { 69821, 69821, 1 },
                    new [] { 69888, 69890, 3 },
                    new [] { 69927, 69931, 3 },
                    new [] { 69932, 69932, 10 },
                    new [] { 69933, 69940, 3 },
                    new [] { 70003, 70003, 3 },
                    new [] { 70016, 70017, 3 },
                    new [] { 70018, 70018, 10 },
                    new [] { 70067, 70069, 10 },
                    new [] { 70070, 70078, 3 },
                    new [] { 70079, 70080, 10 },
                    new [] { 70188, 70190, 10 },
                    new [] { 70191, 70193, 3 },
                    new [] { 70194, 70195, 10 },
                    new [] { 70196, 70196, 3 },
                    new [] { 70197, 70197, 10 },
                    new [] { 70198, 70199, 3 },
                    new [] { 70367, 70367, 3 },
                    new [] { 70368, 70370, 10 },
                    new [] { 70371, 70378, 3 },
                    new [] { 70401, 70401, 3 },
                    new [] { 70402, 70403, 10 },
                    new [] { 70460, 70460, 3 },
                    new [] { 70462, 70462, 3 },
                    new [] { 70463, 70463, 10 },
                    new [] { 70464, 70464, 3 },
                    new [] { 70465, 70468, 10 },
                    new [] { 70471, 70472, 10 },
                    new [] { 70475, 70477, 10 },
                    new [] { 70487, 70487, 3 },
                    new [] { 70498, 70499, 10 },
                    new [] { 70502, 70508, 3 },
                    new [] { 70512, 70516, 3 },
                    new [] { 70832, 70832, 3 },
                    new [] { 70833, 70834, 10 },
                    new [] { 70835, 70840, 3 },
                    new [] { 70841, 70841, 10 },
                    new [] { 70842, 70842, 3 },
                    new [] { 70843, 70844, 10 },
                    new [] { 70845, 70845, 3 },
                    new [] { 70846, 70846, 10 },
                    new [] { 70847, 70848, 3 },
                    new [] { 70849, 70849, 10 },
                    new [] { 70850, 70851, 3 },
                    new [] { 71087, 71087, 3 },
                    new [] { 71088, 71089, 10 },
                    new [] { 71090, 71093, 3 },
                    new [] { 71096, 71099, 10 },
                    new [] { 71100, 71101, 3 },
                    new [] { 71102, 71102, 10 },
                    new [] { 71103, 71104, 3 },
                    new [] { 71216, 71218, 10 },
                    new [] { 71219, 71226, 3 },
                    new [] { 71227, 71228, 10 },
                    new [] { 71229, 71229, 3 },
                    new [] { 71230, 71230, 10 },
                    new [] { 71231, 71232, 3 },
                    new [] { 71339, 71339, 3 },
                    new [] { 71340, 71340, 10 },
                    new [] { 71341, 71341, 3 },
                    new [] { 71342, 71343, 10 },
                    new [] { 71344, 71349, 3 },
                    new [] { 71350, 71350, 10 },
                    new [] { 71351, 71351, 3 },
                    new [] { 92912, 92916, 3 },
                    new [] { 92976, 92982, 3 },
                    new [] { 94033, 94078, 10 },
                    new [] { 94095, 94098, 3 },
                    new [] { 113821, 113822, 3 },
                    new [] { 113824, 113827, 1 },
                    new [] { 119141, 119141, 3 },
                    new [] { 119142, 119142, 10 },
                    new [] { 119143, 119145, 3 },
                    new [] { 119149, 119149, 10 },
                    new [] { 119150, 119154, 3 },
                    new [] { 119155, 119162, 1 },
                    new [] { 119163, 119170, 3 },
                    new [] { 119173, 119179, 3 },
                    new [] { 119210, 119213, 3 },
                    new [] { 119362, 119364, 3 },
                    new [] { 125136, 125142, 3 },
                    new [] { 917504, 917759, 1 },
                    new [] { 917760, 917999, 3 },
                    new [] { 918000, 921599, 1 }
                };

                for (var i = 0; i < ranges.Length; ++i)
                {
                    var range = ranges[i];

                    var node = new RedBlackTreeNode<GraphemeClusterBreakRange>() { Value = new GraphemeClusterBreakRange(range[0], range[1], (GraphemeClusterBreakType)range[2]) };

                    RedBlackTree.InsertRight(node, ref _graphemeClusterBreakRanges);
                    RedBlackTree.Balance(node, ref _graphemeClusterBreakRanges);
                }

                ranges = null;
            }

            struct GraphemeClusterBreakRange
            {
                public GraphemeClusterBreakRange(int index, int indexEnd, GraphemeClusterBreakType type)
                {
                    Index = index;
                    IndexEnd = indexEnd;
                    Type = type;
                }

                public int Index, IndexEnd;
                public GraphemeClusterBreakType Type;
            }

            enum GraphemeClusterBreakType
            {
                Other,
                Control,
                Cr,
                Extend,
                L,
                Lf,
                Lv,
                Lvt,
                T,
                V,
                SpacingMark,
                Prepend,
                Count
            }
        }
    }
}